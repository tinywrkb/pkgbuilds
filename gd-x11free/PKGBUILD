# Maintainer: tinywrkb <tinywrkb@gmail.com>
# Contributor: Pierre Schmitz <pierre@archlinux.de>

_pkgname=gd
pkgname=${_pkgname}-x11free
pkgver=2.3.2
pkgrel=4
pkgdesc="Library for the dynamic creation of images by programmers"
arch=('x86_64')
url="https://libgd.github.io/"
license=('custom')
depends=('fontconfig' 'libwebp' 'libavif' 'libheif-minimal')
optdepends=('perl: bdftogd script')
makedepends=('cmake')
conflicts=($_pkgname)
provides=($_pkgname)
source=("https://github.com/libgd/libgd/archive/${_pkgname}-${pkgver}.tar.gz")
sha256sums=('dcc22244d775f469bee21dce1ea42552adbb72ba0cc423f9fa6a64601b3a1893')

build() {
  cd libgd-${_pkgname}-${pkgver}

  ./bootstrap.sh
  cmake -B build \
    -DCMAKE_INSTALL_PREFIX=/usr \
    -DENABLE_XPM=OFF \

  make -C build
}

package() {
  cd libgd-${_pkgname}-${pkgver}

  make -C build DESTDIR="${pkgdir}" install
  install -D -m644 COPYING "${pkgdir}/usr/share/licenses/${pkgname}/LICENSE"
}
