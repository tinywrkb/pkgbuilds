# Maintainer: tinywrkb <tinywrkb@gmail.com>

_pkgname=samba
pkgname=uosys-mods-${_pkgname}
pkgver=2021.06.19.1
pkgrel=1
pkgdesc="$_pkgname uosys mods"
arch=('any')
licesne=('GPL')
url='https://github.com/uosys/pkgbuilds'
depends=('uosys-mods')
source=(patch smb.conf)
sha256sums=('SKIP' 'SKIP')

build(){

  cat << EOF > mods
#target_list=()

#mv_list=()

rmdir_list=(samba/private)

link_list=(samba/private)
EOF

  cat << EOF > tmpfiles.d.conf
# $_pkgname
# use include directive instead of copying a template config
#C /var/etc/samba - - - - /usr/share/etc/samba
d /var/etc/samba - - - - -
d /var/etc/samba/private 0700 - - - -
f /var/etc/samba/local.conf - - - - -
d /var/cache/samba - - - - -
d /var/lib/ctdb - - - - -
d /var/lib/ctdb/persistent - - - - -
d /var/lib/ctdb/state - - - - -
d /var/lib/ctdb/volatile - - - - -
d /var/lib/samba - - - - -
d /var/lib/samba/bind-dns 0770 - - - -
d /var/lib/samba/private 0700 - - - -
d /var/spool/samba 1777 - - - -
EOF
}

package() {
  depends+=($_pkgname)
  source /usr/lib/os/os-mods-install
  install -Dm644 smb.conf ${pkgdir}/etc/samba/smb.conf
}
